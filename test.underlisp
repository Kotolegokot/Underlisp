(program
  (print-ln "Hi! I'm a stupid calculator. I can either multiply or add two numbers.")
  (print-ln "Please, type either + or *, and then two numbers")
  (flush)

  (let ((get-int (lambda () (str-to-int (get-line))))
        (print-number (lambda (x) (print "Your number is ") (print-ln x))))

    (let ((input (get-line)))
      (if (= input "*")
        (let ((n1 (get-int)) (n2 (get-int)) (mult (* n1 n2)))
          (print-number mult)
          (flush)
        )
        (if (= input "+")
          (let ((n1 (get-int)) (n2 (get-int)) (sum (+ n1 n2)))
            (print-number sum)
            (flush)
          )
          (print-ln "Error: you entered neither + or *. Go to hell, bitch.")
        )
      )
    )
  )
)
