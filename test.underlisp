(program
  (print-ln "Hi! I'm a stupid calculator. I can either multiply or add two numbers or calculate a factorial.")
  (print-ln "Please, type either '+' or '*', and then two numbers, or 'factorial' and then one number")
  (flush)

  (let ((get-int (lambda () (str-to-int (get-line))))
        (get-float (lambda () (str-to-float (get-line))))
        (print-number (lambda (x) (print "Your number is ") (print-ln x)))
        (factorial (lambda (x) (if (<= x 1) 1 (* x (factorial (- x 1)))))))

    (let ((input (get-line)))
      (if (= input "*")
        (let ((n1 (get-float)) (n2 (get-int)) (mult (* n1 n2)))
          (print-number mult)
          (flush)
        )
        (if (= input "+")
          (let ((n1 (get-float)) (n2 (get-int)) (sum (+ n1 n2)))
            (print-number sum)
            (flush)
          )
          (if (= input "factorial")
            (let ((n (get-int)) (f (factorial n)))
              (print-number f)
              (flush)
            )
            (print-ln "Error: you entered neither + or *. Go to hell, bitch.")
          )
        )
      )
    )
  )
)
